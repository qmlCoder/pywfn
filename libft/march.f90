module march
  use iso_c_binding
  use omp_lib
  implicit none
  ! real(c_double),allocatable :: verts(:,:)
  ! integer(c_int),allocatable :: faces(:,:)

  integer(c_int) :: didx(3, 8)
  integer(c_int) :: nums(256), idxs(24, 256) !每个key对应的面的数量，每个面对应的索引数组
  integer(c_int) :: bonds(2, 12)
  data didx(:, 1)/0, 0, 0/
  data didx(:, 2)/1, 0, 0/
  data didx(:, 3)/1, 1, 0/
  data didx(:, 4)/0, 1, 0/
  data didx(:, 5)/0, 0, 1/
  data didx(:, 6)/1, 0, 1/
  data didx(:, 7)/1, 1, 1/
  data didx(:, 8)/0, 1, 1/

  ! 不同类型的正方体的面的数量
  data nums(1:10)/0, 1, 1, 2, 1, 2, 2, 3, 1, 2/
  data nums(11:20)/2, 3, 2, 3, 3, 2, 1, 2, 2, 3/
  data nums(21:30)/2, 3, 3, 4, 2, 3, 3, 4, 3, 4/
  data nums(31:40)/4, 3, 1, 2, 2, 3, 2, 3, 3, 4/
  data nums(41:50)/2, 3, 3, 4, 3, 4, 4, 3, 2, 3/
  data nums(51:60)/3, 2, 3, 4, 4, 3, 3, 4, 4, 3/
  data nums(61:70)/4, 3, 3, 2, 1, 2, 2, 3, 2, 3/
  data nums(71:80)/3, 4, 2, 3, 3, 4, 3, 4, 4, 3/
  data nums(81:90)/2, 3, 3, 4, 3, 4, 4, 3, 3, 4/
  data nums(91:100)/8, 3, 4, 3, 3, 2, 2, 3, 3, 4/
  data nums(101:110)/3, 4, 2, 3, 3, 4, 4, 3, 4, 3/
  data nums(111:120)/3, 2, 3, 4, 4, 3, 4, 3, 3, 2/
  data nums(121:130)/4, 3, 3, 2, 3, 2, 2, 1, 1, 2/
  data nums(131:140)/2, 3, 2, 3, 3, 4, 2, 3, 3, 4/
  data nums(141:150)/3, 4, 4, 3, 2, 3, 3, 4, 3, 4/
  data nums(151:160)/4, 3, 3, 2, 4, 3, 4, 3, 3, 2/
  data nums(161:170)/2, 3, 3, 4, 3, 8, 4, 3, 3, 4/
  data nums(171:180)/4, 3, 4, 3, 3, 2, 3, 4, 4, 3/
  data nums(181:190)/4, 3, 3, 2, 4, 3, 3, 2, 3, 2/
  data nums(191:200)/2, 1, 2, 3, 3, 4, 3, 4, 4, 3/
  data nums(201:210)/3, 4, 4, 3, 2, 3, 3, 2, 3, 4/
  data nums(211:220)/4, 3, 4, 3, 3, 2, 4, 3, 3, 2/
  data nums(221:230)/3, 2, 2, 1, 3, 4, 4, 3, 4, 3/
  data nums(231:240)/3, 2, 4, 3, 3, 2, 3, 2, 2, 1/
  data nums(241:250)/2, 3, 3, 2, 3, 2, 2, 1, 3, 2/
  data nums(251:256)/2, 1, 2, 1, 1, 0/

  ! 正方体12个棱的索引
  data idxs(:, 1)/0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 2)/6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 3)/5, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 4)/6, 5, 11, 11, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 5)/4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 6)/4, 8, 9, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 7)/5, 4, 10, 10, 4, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 8)/5, 4, 8, 5, 8, 11, 5, 11, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 9)/7, 11, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 10)/7, 6, 8, 8, 6, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 11)/7, 11, 8, 5, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 12)/6, 5, 9, 6, 9, 8, 6, 8, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 13)/4, 7, 9, 9, 7, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 14)/7, 6, 10, 7, 10, 9, 7, 9, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 15)/4, 7, 11, 4, 11, 10, 4, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 16)/5, 4, 7, 5, 7, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 17)/6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 18)/2, 10, 3, 3, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 19)/9, 10, 5, 3, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 20)/11, 3, 2, 11, 2, 5, 11, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 21)/3, 2, 6, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 22)/2, 10, 11, 2, 11, 3, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 23)/8, 10, 5, 8, 5, 4, 3, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 24)/5, 4, 8, 5, 8, 11, 5, 11, 2, 2, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 25)/8, 7, 11, 2, 6, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 26)/10, 8, 7, 10, 7, 3, 10, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 27)/3, 2, 6, 8, 7, 11, 5, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 28)/5, 9, 8, 5, 8, 2, 2, 8, 7, 2, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 29)/4, 7, 11, 4, 11, 9, 2, 6, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 30)/7, 3, 2, 7, 2, 10, 7, 10, 9, 7, 9, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 31)/4, 7, 11, 4, 11, 10, 4, 10, 5, 2, 6, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 32)/2, 5, 4, 3, 2, 4, 7, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 33)/5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 34)/2, 1, 5, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 35)/10, 2, 9, 9, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 36)/9, 11, 6, 9, 6, 2, 9, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 37)/2, 1, 5, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 38)/2, 1, 5, 11, 6, 10, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 39)/10, 2, 1, 10, 1, 4, 10, 4, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 40)/4, 8, 11, 4, 11, 1, 1, 11, 6, 1, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 41)/2, 1, 5, 7, 11, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 42)/7, 6, 10, 7, 10, 8, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 43)/1, 9, 10, 1, 10, 2, 7, 11, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 44)/6, 2, 1, 6, 1, 9, 6, 9, 8, 6, 8, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 45)/11, 9, 4, 11, 4, 7, 2, 1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 46)/7, 6, 10, 7, 10, 9, 7, 9, 4, 1, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 47)/4, 7, 11, 4, 11, 10, 4, 10, 1, 1, 10, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 48)/1, 4, 7, 2, 1, 7, 6, 2, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 49)/5, 6, 1, 1, 6, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 50)/3, 1, 5, 3, 5, 10, 3, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 51)/1, 9, 10, 1, 10, 6, 1, 6, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 52)/1, 9, 11, 1, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 53)/3, 1, 5, 3, 5, 6, 8, 9, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 54)/3, 1, 5, 3, 5, 10, 3, 10, 11, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 55)/10, 6, 3, 8, 10, 3, 4, 8, 3, 1, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 56)/8, 11, 3, 4, 8, 3, 1, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 57)/5, 6, 3, 5, 3, 1, 8, 7, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 58)/10, 8, 7, 10, 7, 3, 10, 3, 5, 5, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 59)/7, 3, 1, 8, 7, 1, 9, 8, 1, 6, 11, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 60)/1, 9, 8, 1, 8, 7, 1, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 61)/3, 1, 7, 7, 1, 4, 5, 6, 11, 5, 11, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 62)/1, 4, 7, 3, 1, 7, 9, 5, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 63)/7, 3, 1, 4, 7, 1, 6, 11, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 64)/3, 4, 7, 1, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 65)/4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 66)/1, 0, 4, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 67)/0, 4, 1, 10, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 68)/6, 5, 9, 6, 9, 11, 0, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 69)/0, 8, 1, 1, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 70)/0, 8, 9, 0, 9, 1, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 71)/1, 0, 8, 5, 1, 8, 10, 5, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 72)/5, 1, 0, 5, 0, 8, 5, 8, 11, 5, 11, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 73)/1, 0, 4, 11, 8, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 74)/10, 8, 7, 10, 7, 6, 1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 75)/1, 0, 4, 10, 5, 9, 7, 11, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 76)/6, 5, 9, 6, 9, 8, 6, 8, 7, 0, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 77)/9, 1, 0, 9, 0, 7, 9, 7, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 78)/7, 6, 10, 7, 10, 9, 7, 9, 0, 0, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 79)/7, 11, 10, 7, 10, 0, 0, 10, 5, 0, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 80)/0, 7, 6, 1, 0, 6, 5, 1, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 81)/6, 3, 2, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 82)/11, 3, 2, 11, 2, 10, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 83)/9, 10, 5, 0, 4, 1, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 84)/4, 9, 11, 0, 4, 11, 3, 0, 11, 1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 85)/9, 1, 0, 9, 0, 8, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 86)/0, 9, 1, 8, 9, 0, 3, 2, 10, 11, 3, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 87)/3, 0, 8, 6, 3, 8, 10, 6, 8, 1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 88)/3, 0, 8, 11, 3, 8, 1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 89)/11, 8, 7, 2, 6, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 90)/10, 8, 7, 10, 7, 3, 10, 3, 2, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 91)/3, 0, 7, 1, 0, 4, 1, 2, 5, 3, 2, 6, 7, 11, 8, 4, 9, 8, 5, 9, 10, 6, 11, 10/
  data idxs(:, 92)/4, 9, 8, 0, 7, 3, 1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 93)/6, 11, 9, 2, 6, 9, 1, 2, 9, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 94)/1, 2, 10, 9, 1, 10, 3, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 95)/6, 11, 10, 2, 5, 1, 3, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 96)/3, 0, 7, 1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 97)/4, 5, 0, 0, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 98)/4, 5, 2, 4, 2, 0, 11, 6, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 99)/2, 0, 4, 2, 4, 9, 2, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 100)/2, 0, 4, 2, 4, 9, 2, 9, 6, 6, 9, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 101)/0, 8, 9, 0, 9, 5, 0, 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 102)/0, 8, 9, 0, 9, 5, 0, 5, 2, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 103)/0, 8, 10, 2, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 104)/0, 8, 11, 0, 11, 6, 0, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 105)/2, 0, 4, 2, 4, 5, 11, 8, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 106)/2, 0, 6, 6, 0, 7, 4, 5, 10, 4, 10, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 107)/2, 0, 4, 2, 4, 9, 2, 9, 10, 7, 11, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 108)/0, 7, 6, 2, 0, 6, 8, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 109)/0, 7, 11, 2, 0, 11, 5, 2, 11, 9, 5, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 110)/6, 2, 0, 7, 6, 0, 5, 10, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 111)/11, 10, 2, 7, 11, 2, 0, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 112)/2, 7, 6, 0, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 113)/5, 6, 3, 5, 3, 0, 5, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 114)/3, 0, 4, 11, 3, 4, 10, 11, 4, 5, 10, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 115)/9, 10, 6, 3, 9, 6, 4, 9, 3, 0, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 116)/11, 3, 0, 11, 0, 4, 11, 4, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 117)/9, 5, 6, 8, 9, 6, 3, 8, 6, 0, 8, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 118)/8, 11, 3, 0, 8, 3, 10, 9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 119)/3, 0, 8, 6, 3, 8, 10, 6, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 120)/0, 8, 11, 0, 11, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 121)/8, 4, 5, 11, 8, 5, 6, 11, 5, 0, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 122)/8, 4, 5, 10, 8, 5, 0, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 123)/7, 3, 0, 8, 4, 9, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 124)/7, 3, 0, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 125)/6, 11, 9, 5, 6, 9, 7, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 126)/7, 3, 0, 10, 9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 127)/7, 3, 0, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 128)/3, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 129)/7, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 130)/0, 3, 7, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 131)/0, 3, 7, 5, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 132)/9, 11, 6, 9, 6, 5, 0, 3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 133)/0, 3, 7, 4, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 134)/0, 3, 7, 9, 4, 8, 6, 10, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 135)/5, 4, 8, 5, 8, 10, 3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 136)/5, 4, 8, 5, 8, 11, 5, 11, 6, 3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 137)/11, 8, 0, 3, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 138)/8, 0, 3, 8, 3, 6, 8, 6, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 139)/3, 11, 8, 3, 8, 0, 5, 9, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 140)/6, 5, 9, 6, 9, 8, 6, 8, 3, 3, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 141)/0, 3, 11, 4, 0, 11, 9, 4, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 142)/6, 10, 9, 6, 9, 3, 3, 9, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 143)/4, 0, 3, 4, 3, 11, 4, 11, 10, 4, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 144)/3, 6, 5, 0, 3, 5, 4, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 145)/6, 7, 2, 2, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 146)/2, 10, 11, 2, 11, 7, 2, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 147)/0, 2, 6, 0, 6, 7, 9, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 148)/11, 7, 0, 11, 0, 2, 11, 2, 5, 11, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 149)/6, 7, 0, 6, 0, 2, 9, 4, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 150)/4, 0, 2, 9, 4, 2, 10, 9, 2, 8, 11, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 151)/6, 0, 2, 7, 0, 6, 10, 5, 4, 8, 10, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 152)/4, 0, 2, 5, 4, 2, 7, 8, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 153)/11, 8, 0, 6, 11, 0, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 154)/10, 8, 0, 10, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 155)/9, 8, 0, 5, 9, 0, 2, 5, 0, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 156)/9, 8, 0, 5, 9, 0, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 157)/4, 0, 2, 9, 4, 2, 6, 9, 2, 11, 9, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 158)/4, 0, 2, 9, 4, 2, 10, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 159)/2, 5, 4, 0, 2, 4, 10, 6, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 160)/0, 5, 4, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 161)/7, 0, 3, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 162)/10, 11, 6, 1, 5, 2, 7, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 163)/10, 2, 1, 10, 1, 9, 7, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 164)/9, 11, 6, 9, 6, 2, 9, 2, 1, 0, 3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 165)/8, 9, 4, 3, 7, 0, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 166)/7, 0, 3, 4, 0, 1, 5, 2, 1, 6, 2, 3, 8, 11, 7, 8, 9, 4, 10, 9, 5, 10, 11, 6/
  data idxs(:, 167)/7, 8, 10, 3, 7, 10, 2, 3, 10, 0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 168)/7, 8, 11, 3, 6, 2, 0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 169)/8, 0, 3, 8, 3, 11, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 170)/8, 0, 3, 8, 3, 6, 8, 6, 10, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 171)/1, 9, 0, 0, 9, 8, 10, 2, 3, 10, 3, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 172)/0, 1, 9, 8, 0, 9, 2, 3, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 173)/11, 9, 4, 11, 4, 0, 11, 0, 3, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 174)/5, 10, 9, 1, 4, 0, 2, 3, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 175)/2, 3, 11, 10, 2, 11, 0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 176)/2, 3, 6, 0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 177)/6, 7, 0, 6, 0, 1, 6, 1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 178)/10, 11, 7, 0, 10, 7, 5, 10, 0, 1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 179)/10, 6, 7, 9, 10, 7, 0, 9, 7, 1, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 180)/0, 1, 9, 7, 0, 9, 11, 7, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 181)/9, 5, 6, 8, 9, 6, 7, 8, 6, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 182)/4, 0, 1, 9, 5, 10, 8, 11, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 183)/7, 8, 10, 6, 7, 10, 4, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 184)/4, 0, 1, 7, 8, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 185)/0, 1, 5, 8, 0, 5, 11, 8, 5, 6, 11, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 186)/8, 0, 1, 8, 1, 5, 8, 5, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 187)/9, 8, 0, 1, 9, 0, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 188)/1, 8, 0, 9, 8, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 189)/9, 5, 6, 11, 9, 6, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 190)/1, 4, 0, 9, 5, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 191)/4, 0, 1, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 192)/0, 1, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 193)/7, 4, 3, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 194)/1, 3, 7, 1, 7, 4, 10, 11, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 195)/7, 4, 1, 7, 1, 3, 10, 5, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 196)/7, 1, 3, 4, 1, 7, 11, 6, 5, 9, 11, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 197)/8, 9, 1, 7, 8, 1, 3, 7, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 198)/1, 3, 7, 1, 7, 8, 1, 8, 9, 10, 11, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 199)/7, 8, 10, 3, 7, 10, 5, 3, 10, 1, 3, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 200)/3, 6, 5, 1, 3, 5, 11, 7, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 201)/3, 11, 8, 3, 8, 4, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 202)/3, 6, 10, 3, 10, 8, 3, 8, 4, 3, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 203)/5, 1, 3, 10, 5, 3, 11, 10, 3, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 204)/5, 1, 3, 6, 5, 3, 4, 9, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 205)/11, 9, 1, 3, 11, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 206)/10, 9, 1, 6, 10, 1, 3, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 207)/5, 1, 3, 10, 5, 3, 11, 10, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 208)/1, 6, 5, 3, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 209)/7, 4, 1, 7, 1, 2, 7, 2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 210)/11, 7, 4, 10, 11, 4, 1, 10, 4, 2, 10, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 211)/10, 6, 7, 9, 10, 7, 4, 9, 7, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 212)/4, 9, 11, 7, 4, 11, 5, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 213)/1, 2, 6, 9, 1, 6, 8, 9, 6, 7, 8, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 214)/10, 9, 1, 2, 10, 1, 8, 11, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 215)/10, 6, 7, 8, 10, 7, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 216)/5, 1, 2, 8, 11, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 217)/11, 8, 4, 1, 11, 4, 6, 11, 1, 2, 6, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 218)/1, 2, 10, 4, 1, 10, 8, 4, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 219)/5, 1, 2, 10, 6, 11, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 220)/5, 1, 2, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 221)/6, 11, 9, 2, 6, 9, 1, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 222)/9, 2, 10, 1, 2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 223)/5, 1, 2, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 224)/1, 2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 225)/4, 5, 2, 4, 2, 3, 4, 3, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 226)/11, 7, 4, 10, 11, 4, 5, 10, 4, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 227)/2, 3, 7, 10, 2, 7, 9, 10, 7, 4, 9, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 228)/11, 7, 4, 9, 11, 4, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 229)/8, 9, 5, 2, 8, 5, 7, 8, 2, 3, 7, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 230)/6, 2, 3, 11, 7, 8, 10, 9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 231)/7, 8, 10, 3, 7, 10, 2, 3, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 232)/11, 7, 8, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 233)/8, 4, 5, 11, 8, 5, 2, 11, 5, 3, 11, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 234)/5, 10, 8, 4, 5, 8, 6, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 235)/11, 10, 2, 3, 11, 2, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 236)/6, 2, 3, 9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 237)/2, 3, 11, 5, 2, 11, 9, 5, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 238)/5, 10, 9, 6, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 239)/3, 10, 2, 11, 10, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 240)/2, 3, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 241)/7, 4, 5, 6, 7, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 242)/11, 7, 4, 10, 11, 4, 5, 10, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 243)/10, 6, 7, 9, 10, 7, 4, 9, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 244)/9, 7, 4, 11, 7, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 245)/9, 5, 6, 8, 9, 6, 7, 8, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 246)/8, 11, 7, 10, 9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 247)/8, 6, 7, 10, 6, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 248)/8, 11, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 249)/8, 4, 5, 11, 8, 5, 6, 11, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 250)/10, 4, 5, 8, 4, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 251)/9, 8, 4, 11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 252)/9, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 253)/11, 5, 6, 9, 5, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 254)/10, 9, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 255)/11, 10, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  data idxs(:, 256)/0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0/
  ! 八个顶点确定的键
  data bonds(:, 1)/0, 1/
  data bonds(:, 2)/1, 2/
  data bonds(:, 3)/2, 3/
  data bonds(:, 4)/0, 3/
  data bonds(:, 5)/1, 5/
  data bonds(:, 6)/2, 6/
  data bonds(:, 7)/3, 7/
  data bonds(:, 8)/0, 4/
  data bonds(:, 9)/4, 5/
  data bonds(:, 10)/5, 6/
  data bonds(:, 11)/6, 7/
  data bonds(:, 12)/7, 4/
contains
  subroutine grids2voxel(nx, ny, nz, grids, values, voxels) bind(c, name='grids2voxel_') !将格点数据转为体素数据
    integer(c_int), intent(in) :: nx, ny, nz
    real(c_double), intent(in) :: grids(3, nx*ny*nz), values(nx*ny*nz)
    real(c_double), intent(inout) :: voxels(4, nz, ny, nx)

    integer:: i, j, k, n
    !$omp parallel do private(i, j, k, n)
    do i = 1, nx
      do j = 1, ny
        do k = 1, nz
          n = (i - 1)*ny*nz + (j - 1)*nz + k
          voxels(:3, k, j, i) = grids(:, n)
          voxels(4, k, j, i) = values(n)
        end do
      end do
    end do
    !$omp end parallel do
  end subroutine grids2voxel

  subroutine voxel2verts(nx,ny,nz,voxel,isov,verts,count) bind(c,name='voxel2verts_') !将体素数据转为顶点数据
    integer(c_int), intent(in) :: nx,ny,nz
    real(c_double), intent(in) :: voxel(4,nz,ny,nx)
    real(c_double), intent(in) :: isov
    real(c_double),intent(inout) :: verts(3,nx*ny*nz*24) !最多这么多顶点
    integer(c_int),intent(inout) :: count !顶点数量

    real(c_double) :: xyzs(3,8),vals(8)
    real(c_double) :: boxVerts(3,24)
    integer:: i,j,k,l,idx
    integer(c_int) :: key
    ! write(*,'(3I5,F10.4)')nx,ny,nz,isov
    idx=1
    ! count=0
    do i=1,nx-1
      do j=1,ny-1
        do k=1,nz-1
          call get_around(voxel,nx,ny,nz,i,j,k,xyzs,vals)
          if ( minval(vals) < isov .and. isov < maxval(vals) ) then
            key=1
            do l=1,8
              key=key+merge(1,0,vals(9-l)>isov)*2**(l-1)
            end do
            write(*,'(A,I3,8F10.4)')'key=',key,vals
            call get_boxVerts(key,xyzs,vals,isov,boxVerts)
            ! write(*,'(A,4I3)')'key=',key,idx,idx+nums(key)*3,count
            verts(:,idx:idx+nums(key)*3-1)=boxVerts(:,:nums(key)*3)
            idx=idx+nums(key)*3
            count=count+nums(key)*3
          end if
        end do
      end do
    end do
  end subroutine voxel2verts

  subroutine get_around(voxel, nx, ny, nz, i, j, k, xyzs, vals) !获取周围格点坐标和数值
    integer(c_int), intent(in) :: nx, ny, nz, i, j, k
    real(c_double), intent(in) :: voxel(4, nz, ny, nx)
    real(c_double), intent(out) :: xyzs(3, 8)
    real(c_double), intent(out) :: vals(8)
    integer::n, di, dj, dk
    ! write(*,'(A,3I3)')'ijk=',i,j,k
    do n = 1, 8
      di = didx(1, n)
      dj = didx(2, n)
      dk = didx(3, n)
      xyzs(:, n) = voxel(:3, k + dk, j + dj, i + di)
      vals(n) = voxel(4, k + dk, j + dj, i + di)
      ! write(*,'(I3,4F10.4,3I3)')n,xyzs(:,n),vals(n),i+di,j+dj,k+dk
    end do
  end subroutine get_around

  subroutine get_boxVerts(key, xyzs, vals, isov, boxVerts) !获取顶点坐标和数值
    ! 传入正方体八个顶点的坐标和数值，以及等值面值，返回等值面顶点坐标
    integer(c_int), intent(in) :: key
    real(c_double), intent(in) :: xyzs(3, 8), vals(8)
    real(c_double), intent(in) :: isov
    real(c_double), intent(out) :: boxVerts(3, 24)
    integer(c_int)::nface ! 面的数量，最多为8个面，24个点
    integer(c_int)::face(3) !面的顶点索引
    real(c_double)::pa(3), pb(3), va, vb, k
    integer::f, p, e, a, b
    nface = nums(key)
    write(*,'(2I3)')key, nface
    do f = 1, nface
      face(:) = idxs((f - 1)*3 + 1:(f - 1)*3 + 3, key) !面对应的顶点索引
      write(*,'(4I3)')f,face(:)
      do p = 1, 3 ! 面的三个点
        e = face(p) + 1
        a = bonds(1, e) + 1 ! 每个顶点由一条边确定，也就是两个网格点确定
        b = bonds(2, e) + 1
        pa = xyzs(:, a)
        pb = xyzs(:, b)
        va = vals(a)
        vb = vals(b)
        ! write(*,'(5I3,8F10.4)')f,p,e,a,b,pa,pb,va,vb
        if (va == vb) then
          k = 0.5
        else
          k = (isov - va)/(vb - va)
        end if
        boxVerts(:, (f - 1)*3 + p) = pa + k*(pb - pa)
        ! write(*,'(I3,6F10.4)')(f-1)*3+p,k,boxVerts(:,(f-1)*3+p),va,vb
      end do
    end do
  end subroutine get_boxVerts

  subroutine vertsMerge(thval, nvert, old_verts, new_verts, faces, vcount, fcount) bind(c, name="vertsMerge_") ! 合并顶点，改变顶点的数量但不改变三角形的数量
    integer(c_int), intent(in) :: nvert !顶点的数量, 阈值
    real(c_double), intent(in) :: thval !顶点的数量, 阈值
    real(c_double), intent(inout) :: old_verts(3, nvert)
    real(c_double), intent(inout) :: new_verts(3, nvert)
    integer(c_int), intent(inout) :: faces(nvert) !原始的面索引就是 1,2,3,4,5...nvert
    integer(c_int), intent(out) :: vcount, fcount !合并后顶点的数量

    real(c_double) :: vector(3) !计算两个顶点之间的向量
    integer(c_int) :: vertMap(nvert) !顶点映射表，新旧顶点之间的映射
    integer(c_int) :: vertTag(nvert) !顶点标签，用于标记顶点是否被合并
    integer(c_int) :: i, j, idx
    real(c_double) :: dist !计算每两个顶点之间的距离
    vertTag = 0
    idx = 1
    vcount = 0
    do i = 1, nvert
      if (vertTag(i) == 1) cycle
      new_verts(:, idx) = old_verts(:, i)
      vcount = vcount + 1
      do j = 1, nvert
        vector = old_verts(:, i) - old_verts(:, j) !计算两个顶点之间的向量
        dist = sqrt(dot_product(vector, vector)) !计算两个顶点之间的距离
        if (dist < thval) then
          vertMap(j) = idx
          vertTag(j) = 1
        end if
      end do
      idx = idx + 1
    end do
    idx = 1
    fcount = 0
    do i = 1, nvert, 3
      if (vertMap(i) == vertMap(i + 1)) cycle
      if (vertMap(i) == vertMap(i + 2)) cycle
      if (vertMap(i + 1) == vertMap(i + 2)) cycle
      faces(idx) = vertMap(i)
      faces(idx + 1) = vertMap(i + 1)
      faces(idx + 2) = vertMap(i + 2)
      fcount = fcount + 1
      idx = idx + 3
    end do
  end subroutine vertsMerge

  subroutine vertsShift(nvert, verts) bind(c, name="vertsShift_") ! 顶点位移
    integer(c_int), intent(in) :: nvert
    real(c_double), intent(inout) :: verts(3, nvert)

    real(c_double) :: distMat(nvert, nvert) !计算每两个顶点之间的距离
    real(c_double) :: dist !两个顶点之间的距离
    real(c_double) :: center(3) ! 一个顶点周围的顶点的中心坐标
    integer(c_int) :: ncent !周围顶点的数量
    integer :: i, j
    do i = 1, nvert
      do j = 1, nvert
        dist = sqrt(dot_product(verts(:, i) - verts(:, j), verts(:, i) - verts(:, j))) !计算两个顶点之间的距离
        distMat(i, j) = dist
        distMat(j, i) = dist
      end do
    end do
    do i = 1, nvert
      center = [0.0, 0.0, 0.0]
      ncent = 0
      do j = 1, nvert
        if (distMat(i, j) > 0.05) cycle
        ncent = ncent + 1
        center = center + verts(:, j)
      end do
      if (ncent == 0) cycle
      center = center/ncent
      verts(:, i) = verts(:, i) + (center - verts(:, i))*0.5
    end do

  end subroutine vertsShift
end module march
