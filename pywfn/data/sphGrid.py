"""
由pyscf生成的数据
计算球形积分格点坐标及权重[N,4]
x,y,z,w
根据径向数据和角度数据动态生成网格数据
"""
import numpy as np
from pathlib import Path
from pywfn import config
# 径向数据 [r,w]
radData=np.array([
[9.6536e+00,1.1055e+02],
[9.1156e+00,8.9016e+01],
[8.6273e+00,7.2715e+01],
[8.1802e+00,6.0097e+01],
[7.7678e+00,5.0147e+01],
[7.3851e+00,4.2180e+01],
[7.0281e+00,3.5717e+01],
[6.6936e+00,3.0413e+01],
[6.3791e+00,2.6019e+01],
[6.0824e+00,2.2349e+01],
[5.8016e+00,1.9261e+01],
[5.5354e+00,1.6646e+01],
[5.2825e+00,1.4420e+01],
[5.0416e+00,1.2516e+01],
[4.8120e+00,1.0880e+01],
[4.5927e+00,9.4699e+00],
[4.3830e+00,8.2505e+00],
[4.1824e+00,7.1931e+00],
[3.9902e+00,6.2742e+00],
[3.8059e+00,5.4741e+00],
[3.6291e+00,4.7762e+00],
[3.4595e+00,4.1668e+00],
[3.2966e+00,3.6340e+00],
[3.1401e+00,3.1679e+00],
[2.9897e+00,2.7598e+00],
[2.8451e+00,2.4024e+00],
[2.7062e+00,2.0894e+00],
[2.5726e+00,1.8153e+00],
[2.4442e+00,1.5753e+00],
[2.3207e+00,1.3652e+00],
[2.2020e+00,1.1815e+00],
[2.0880e+00,1.0209e+00],
[1.9784e+00,8.8061e-01],
[1.8731e+00,7.5824e-01],
[1.7720e+00,6.5162e-01],
[1.6749e+00,5.5883e-01],
[1.5817e+00,4.7822e-01],
[1.4923e+00,4.0828e-01],
[1.4066e+00,3.4772e-01],
[1.3244e+00,2.9538e-01],
[1.2458e+00,2.5023e-01],
[1.1704e+00,2.1138e-01],
[1.0984e+00,1.7802e-01],
[1.0295e+00,1.4945e-01],
[9.6369e-01,1.2505e-01],
[9.0089e-01,1.0426e-01],
[8.4099e-01,8.6611e-02],
[7.8392e-01,7.1671e-02],
[7.2959e-01,5.9066e-02],
[6.7793e-01,4.8470e-02],
[6.2885e-01,3.9596e-02],
[5.8229e-01,3.2194e-02],
[5.3816e-01,2.6045e-02],
[4.9639e-01,2.0959e-02],
[4.5691e-01,1.6773e-02],
[4.1964e-01,1.3345e-02],
[3.8452e-01,1.0551e-02],
[3.5147e-01,8.2878e-03],
[3.2043e-01,6.4647e-03],
[2.9132e-01,5.0055e-03],
[2.6408e-01,3.8454e-03],
[2.3865e-01,2.9295e-03],
[2.1494e-01,2.2119e-03],
[1.9291e-01,1.6542e-03],
[1.7247e-01,1.2246e-03],
[1.5357e-01,8.9665e-04],
[1.3614e-01,6.4883e-04],
[1.2012e-01,4.6356e-04],
[1.0545e-01,3.2666e-04],
[9.2048e-02,2.2677e-04],
[7.9867e-02,1.5489e-04],
[6.8840e-02,1.0392e-04],
[5.8906e-02,6.8375e-05],
[5.0002e-02,4.4029e-05],
[4.2069e-02,2.7682e-05],
[3.5046e-02,1.6947e-05],
[2.8873e-02,1.0070e-05],
[2.3491e-02,5.7857e-06],
[1.8841e-02,3.1989e-06],
[1.4866e-02,1.6925e-06],
[1.1509e-02,8.5089e-07],
[8.7137e-03,4.0287e-07],
[6.4242e-03,1.7760e-07],
[4.5862e-03,7.1807e-08],
[3.1465e-03,2.6089e-08],
[2.0526e-03,8.2779e-09],
[1.2535e-03,2.1996e-09],
[6.9948e-04,4.5869e-10],
[3.4253e-04,6.7329e-11],
[1.3643e-04,5.6731e-12],
[3.7277e-05,1.7358e-13],
])

# 角度数据 [x,y,z,w]
sphData=np.array([
[-1.        ,  0.        ,  0.        ,  0.00597464],
[-0.70710678,  0.        ,  0.70710678,  0.19335357],
[-0.70710678,  0.        , -0.70710678,  0.19335357],
[-0.70710678,  0.70710678,  0.        ,  0.19335357],
[-0.70710678, -0.70710678,  0.        ,  0.19335357],
[-0.57735027,  0.57735027,  0.57735027, -0.34452796],
[-0.57735027, -0.57735027,  0.57735027, -0.34452796],
[-0.57735027,  0.57735027, -0.57735027, -0.34452796],
[-0.57735027, -0.57735027, -0.57735027, -0.34452796],
[-0.48038446,  0.48038446,  0.73379939,  0.30947862],
[-0.48038446, -0.48038446,  0.73379939,  0.30947862],
[-0.48038446,  0.48038446, -0.73379939,  0.30947862],
[-0.48038446, -0.48038446, -0.73379939,  0.30947862],
[-0.48038446,  0.73379939,  0.48038446,  0.30947862],
[-0.48038446, -0.73379939,  0.48038446,  0.30947862],
[-0.48038446,  0.73379939, -0.48038446,  0.30947862],
[-0.48038446, -0.73379939, -0.48038446,  0.30947862],
[-0.73379939,  0.48038446,  0.48038446,  0.30947862],
[-0.73379939, -0.48038446,  0.48038446,  0.30947862],
[-0.73379939,  0.48038446, -0.48038446,  0.30947862],
[-0.73379939, -0.48038446, -0.48038446,  0.30947862],
[-0.32077265,  0.94715622,  0.        ,  0.19239987],
[-0.32077265, -0.94715622,  0.        ,  0.19239987],
[-0.94715622,  0.32077265,  0.        ,  0.19239987],
[-0.94715622, -0.32077265,  0.        ,  0.19239987],
[-0.32077265,  0.        ,  0.94715622,  0.19239987],
[-0.32077265,  0.        , -0.94715622,  0.19239987],
[-0.94715622,  0.        ,  0.32077265,  0.19239987],
[-0.94715622,  0.        , -0.32077265,  0.19239987],
[ 1.        ,  0.        ,  0.        ,  0.00597464],
[ 0.        ,  1.        ,  0.        ,  0.00597464],
[ 0.        , -1.        ,  0.        ,  0.00597464],
[ 0.        ,  0.        ,  1.        ,  0.00597464],
[ 0.        ,  0.        , -1.        ,  0.00597464],
[ 0.        ,  0.70710678,  0.70710678,  0.19335357],
[ 0.        , -0.70710678,  0.70710678,  0.19335357],
[ 0.        ,  0.70710678, -0.70710678,  0.19335357],
[ 0.        , -0.70710678, -0.70710678,  0.19335357],
[ 0.70710678,  0.        ,  0.70710678,  0.19335357],
[ 0.70710678,  0.        , -0.70710678,  0.19335357],
[ 0.70710678,  0.70710678,  0.        ,  0.19335357],
[ 0.70710678, -0.70710678,  0.        ,  0.19335357],
[ 0.57735027,  0.57735027,  0.57735027, -0.34452796],
[ 0.57735027, -0.57735027,  0.57735027, -0.34452796],
[ 0.57735027,  0.57735027, -0.57735027, -0.34452796],
[ 0.57735027, -0.57735027, -0.57735027, -0.34452796],
[ 0.48038446,  0.48038446,  0.73379939,  0.30947862],
[ 0.48038446, -0.48038446,  0.73379939,  0.30947862],
[ 0.48038446,  0.48038446, -0.73379939,  0.30947862],
[ 0.48038446, -0.48038446, -0.73379939,  0.30947862],
[ 0.48038446, -0.73379939,  0.48038446,  0.30947862],
[ 0.48038446,  0.73379939, -0.48038446,  0.30947862],
[ 0.48038446, -0.73379939, -0.48038446,  0.30947862],
[ 0.48038446,  0.73379939,  0.48038446,  0.30947862],
[ 0.73379939,  0.48038446,  0.48038446,  0.30947862],
[ 0.73379939, -0.48038446,  0.48038446,  0.30947862],
[ 0.73379939,  0.48038446, -0.48038446,  0.30947862],
[ 0.73379939, -0.48038446, -0.48038446,  0.30947862],
[ 0.32077265,  0.94715622,  0.        ,  0.19239987],
[ 0.32077265, -0.94715622,  0.        ,  0.19239987],
[ 0.94715622,  0.32077265,  0.        ,  0.19239987],
[ 0.94715622, -0.32077265,  0.        ,  0.19239987],
[ 0.32077265,  0.        ,  0.94715622,  0.19239987],
[ 0.32077265,  0.        , -0.94715622,  0.19239987],
[ 0.94715622,  0.        ,  0.32077265,  0.19239987],
[ 0.94715622,  0.        , -0.32077265,  0.19239987],
[ 0.        ,  0.32077265,  0.94715622,  0.19239987],
[ 0.        , -0.32077265,  0.94715622,  0.19239987],
[ 0.        ,  0.32077265, -0.94715622,  0.19239987],
[ 0.        , -0.32077265, -0.94715622,  0.19239987],
[ 0.        ,  0.94715622,  0.32077265,  0.19239987],
[ 0.        , -0.94715622,  0.32077265,  0.19239987],
[ 0.        ,  0.94715622, -0.32077265,  0.19239987],
[ 0.        , -0.94715622, -0.32077265,  0.19239987]])

# 网格数据
# gridData=[]
# for rad,wr in radData:
#     for x,y,z,ws in sphData:
#         gridData.append([rad*x,rad*y,rad*z,wr*ws])

# gridData=np.array(gridData)
dataPath=config.ROOT_DATA/'grid_74,80.npy'
gridData:np.ndarray=np.load(dataPath)
grids=gridData[:,:3].copy()
weits=gridData[:,3].copy()
# gridData.setflags(write=False)

